<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="stylesheet" href="styles.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Excel Toolbox</title>
    <script type="module" src="/main.js" defer></script>
  </head>

  <body>
    <main class="container">
      <header class="hero">
        <div>
          <p class="eyebrow">Local Excel Utility</p>
          <h1>Excel Toolbox</h1>
          <p class="subtitle">Extract, merge, and remove macros from Excel sheets. 100% local.</p>
          <p class="byline">made by chiapuru</p>
        </div>
        <div class="hero-card">
          <div class="card-row">
            <span>Processing</span>
            <span class="badge">Local Only</span>
          </div>
          <div class="card-row">
            <span>Formats</span>
            <span>.xlsx / .xlsm</span>
          </div>
          <div class="card-row">
            <span>Output</span>
            <span>New Excel File</span>
          </div>
        </div>
      </header>

      <div class="tool-tabs" role="tablist" aria-label="Excel toolbox tabs">
        <button class="tool-tab is-active" data-tool="pick" role="tab" aria-selected="true">SheetPick</button>
        <button class="tool-tab" data-tool="merge" role="tab" aria-selected="false">SheetMerge</button>
        <button class="tool-tab" data-tool="macro" role="tab" aria-selected="false">MacroRemover</button>
      </div>

      <div class="tool-panels">
        <div class="tool-panel is-active" data-tool-panel="pick" role="tabpanel">
          <div class="tool-header">
            <h2>SheetPick</h2>
            <p>Extract sheets by keyword match or manual selection.</p>
          </div>

          <section class="panel">
            <div class="section-header">
              <h2>1. Select File</h2>
              <p>Open an Excel file to load the sheet list.</p>
            </div>
            <div class="file-row">
              <button id="pick-select-file" class="btn primary">Select Excel File</button>
              <div class="file-meta">
                <div id="pick-selected-file" class="file-name">Not Selected</div>
                <div id="pick-file-status" class="file-status">Please select a file</div>
              </div>
            </div>
          </section>

          <section class="panel">
            <div class="section-header">
              <h2>2. Extraction Method</h2>
              <p>Extract by keyword search or manual sheet selection.</p>
            </div>

            <div class="mode-switch">
              <label class="radio">
                <input type="radio" name="mode" value="keyword" checked />
                <span>Extract by Keyword</span>
              </label>
              <label class="radio">
                <input type="radio" name="mode" value="selection" />
                <span>Select Sheets</span>
              </label>
            </div>

            <div id="keyword-area" class="input-row">
              <input id="keyword-input" type="text" placeholder="e.g., 2025_Invoice" />
              <span class="hint">Extract sheets containing the specified text.</span>
            </div>

            <div id="selection-area" class="sheet-area hidden">
              <div class="sheet-header">
                <span>Sheet List</span>
                <span id="sheet-count">0 sheets</span>
              </div>
              <div id="sheet-list" class="sheet-list"></div>
            </div>
          </section>

          <section class="panel">
            <div class="section-header">
              <h2>3. Run Extraction</h2>
              <p>Specify the save location and create a new Excel file.</p>
            </div>
            <div class="action-row">
              <button id="pick-run-extract" class="btn accent" disabled>Extract & Save</button>
              <div id="pick-result" class="result">Preparing...</div>
            </div>
          </section>
        </div>

        <div class="tool-panel" data-tool-panel="merge" role="tabpanel">
          <div class="tool-header">
            <h2>SheetMerge</h2>
            <p>Merge multiple Excel files into one, avoiding duplicate sheet names.</p>
          </div>

          <section class="panel">
            <div class="section-header">
              <h2>1. Select Files</h2>
              <p>Select multiple Excel files to merge.</p>
            </div>
            <div class="file-row">
              <button id="merge-select-files" class="btn primary">Select Multiple Excel Files</button>
              <div class="file-meta">
                <div id="merge-selected-files" class="file-name">Not Selected</div>
                <div id="merge-file-status" class="file-status">Please select 2 or more files</div>
              </div>
            </div>
          </section>

          <section class="panel">
            <div class="section-header">
              <h2>2. Run Merge</h2>
              <p>Specify the save location and create a new Excel file.</p>
            </div>
            <div class="action-row">
              <button id="merge-run" class="btn accent" disabled>Merge & Save</button>
              <div id="merge-result" class="result">Preparing...</div>
            </div>
          </section>
        </div>

        <div class="tool-panel" data-tool-panel="macro" role="tabpanel">
          <div class="tool-header">
            <h2>MacroRemover</h2>
            <p>Remove macros from .xlsm and save as .xlsx.</p>
          </div>

          <section class="panel">
            <div class="section-header">
              <h2>1. Select File</h2>
              <p>Open an Excel file with macros.</p>
            </div>
            <div class="file-row">
              <button id="macro-select-file" class="btn primary">Select .xlsm File</button>
              <div class="file-meta">
                <div id="macro-selected-file" class="file-name">Not Selected</div>
                <div id="macro-file-status" class="file-status">Please select an .xlsm file</div>
              </div>
            </div>
          </section>

          <section class="panel">
            <div class="section-header">
              <h2>2. Run Macro Removal</h2>
              <p>Specify the save location and save as .xlsx.</p>
            </div>
            <div class="action-row">
              <button id="macro-run" class="btn accent" disabled>Remove Macros & Save</button>
              <div id="macro-result" class="result">Preparing...</div>
            </div>
          </section>
        </div>
      </div>
    </main>
  </body>
</html>
